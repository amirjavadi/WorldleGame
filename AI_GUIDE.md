# راهنمای هوش مصنوعی برای پروژه Wordle

## دستورالعمل‌های کلی
1. همیشه از زبان فارسی برای ارتباط با کاربر استفاده کنید
2. پیام‌های خطا و موفقیت باید واضح و کاربرپسند باشند
3. در هنگام تغییر کد، اصول SOLID و Clean Code را رعایت کنید
4. تغییرات باید با مستندات موجود هماهنگ باشند

## ساختار پروژه و مدیریت وابستگی‌ها

### مدیریت package.json
1. فقط یک `package.json` در مسیر `WordleFrontend` باید وجود داشته باشد
2. از وجود چندین `package.json` در مسیرهای مختلف پروژه خودداری کنید
3. تمام وابستگی‌های فرانت‌اند باید در `WordleFrontend/package.json` مدیریت شوند
4. هرگونه نصب پکیج جدید باید در مسیر `WordleFrontend` انجام شود

#### ساختار صحیح
```
WorldleGame/
├── WordleFrontend/
│   ├── package.json         # فایل اصلی مدیریت وابستگی‌ها
│   ├── package-lock.json    # فایل قفل وابستگی‌ها
│   └── ...
├── WordleBackend/
│   ├── WordleBackend.csproj # فایل پروژه بک‌اند
│   └── ...
└── ...
```

#### نکات مهم
1. از نصب پکیج در مسیر اصلی پروژه خودداری کنید
2. همیشه از `npm install` در مسیر `WordleFrontend` استفاده کنید
3. در صورت مشاهده `package.json` در مسیر اصلی، آن را حذف کنید
4. برای حل مشکلات وابستگی:
   - `cd WordleFrontend`
   - `rm -rf node_modules`
   - `rm package-lock.json`
   - `npm install`

## ساختار پروژه

### مسیرهای اصلی
```
WordleFrontend/
├── components/     # کامپوننت‌های قابل استفاده مجدد
├── pages/         # صفحات اصلی برنامه
├── stores/        # مدیریت state با Pinia
├── services/      # سرویس‌های مرکزی مثل API
├── composables/   # کامپوزابل‌های Vue
├── plugins/       # پلاگین‌های Nuxt
└── public/        # فایل‌های استاتیک
```

### قوانین ساختاری
1. **مدیریت API**:
   - تمام درخواست‌های API باید در `services/api.js` متمرکز باشند
   - استفاده از الگوی Singleton برای سرویس API
   - گروه‌بندی API‌ها بر اساس عملکرد (auth, game, leaderboard, admin)

2. **مدیریت State**:
   - استفاده از Pinia برای مدیریت state
   - هر store باید در پوشه `stores/` قرار گیرد
   - استفاده از `persist` برای ذخیره‌سازی state در localStorage

3. **احراز هویت**:
   - مدیریت متمرکز در `stores/auth.js`
   - پشتیبانی از حالت مهمان
   - مدیریت توکن و وضعیت کاربر

### الگوهای استاندارد

1. **نام‌گذاری**:
   - کامپوننت‌ها: PascalCase (مثال: `GameBoard.vue`)
   - فایل‌های store: camelCase (مثال: `gameStore.js`)
   - سرویس‌ها: camelCase (مثال: `api.js`)

2. **ساختار کامپوننت‌ها**:
```vue
<template>
  <!-- UI elements -->
</template>

<script setup>
// 1. Imports
// 2. Props/Emits
// 3. Store usage
// 4. Composables
// 5. Local state
// 6. Computed
// 7. Methods
</script>

<style scoped>
/* Component styles */
</style>
```

### چک‌لیست قبل از تغییر
- [ ] آیا این تغییر با ساختار موجود سازگار است؟
- [ ] آیا از سرویس‌های موجود استفاده می‌کند؟
- [ ] آیا نیاز به تغییر ساختار اصلی دارد؟
- [ ] آیا با الگوهای نام‌گذاری هماهنگ است؟

### موارد ممنوع ❌
1. ایجاد سرویس API جدید خارج از `services/api.js`
2. استفاده مستقیم از `fetch` در کامپوننت‌ها
3. تغییر ساختار اصلی بدون دلیل
4. ایجاد store‌های موازی
5. تغییر نام متدهای استاندارد

### موارد مجاز ✅
1. اضافه کردن متد جدید به سرویس‌های موجود
2. ایجاد کامپوننت جدید
3. بهبود عملکرد کد موجود
4. اضافه کردن ویژگی‌های جدید در چارچوب ساختار موجود

## نکات مهم برای توسعه
1. همیشه قبل از شروع کار این راهنما را مطالعه کن
2. در صورت نیاز به تغییر ساختار، ابتدا با کاربر مشورت کن
3. تغییرات را به صورت تدریجی و قابل بازگشت انجام بده
4. مستندات را به روز نگه دار

## مسیر توسعه
1. ابتدا ساختار موجود را بررسی کن
2. تغییرات را در کوچکترین واحد ممکن انجام بده
3. قبل از هر تغییر، تأثیر آن را بر کل سیستم بررسی کن
4. در صورت شک، از کاربر سؤال کن

## مدیریت API ها

### ساختار مدیریت API
- تمام درخواست‌های API باید در فایل `services/api.js` متمرکز شوند
- از الگوی Singleton برای مدیریت API استفاده می‌شود
- هر بخش از API ها (auth, game, leaderboard, admin) در یک namespace جداگانه قرار می‌گیرند

### نحوه پیاده‌سازی
```javascript
// services/api.js
class ApiService {
  constructor() {
    // تنظیمات پایه API
  }

  async request(endpoint, options) {
    // متد مرکزی برای ارسال درخواست‌ها
  }

  // گروه‌بندی API ها
  auth = {
    login: () => {},
    register: () => {},
    verify: () => {}
  }

  game = {
    // متدهای مربوط به بازی
  }

  // سایر گروه‌ها
}

const api = new ApiService()
export default api
```

### نحوه استفاده
```javascript
// در store ها
import api from '~/services/api'

// استفاده از API
await api.auth.login(username, password)
await api.game.submitGuess(guess, token)
```

### نکات مهم
1. از ایجاد composable های جداگانه برای API (مثل useApi یا useAuth) خودداری کنید
2. تمام لاجیک مربوط به درخواست‌ها باید در `services/api.js` باشد
3. store ها فقط باید از این سرویس API استفاده کنند
4. مدیریت خطاها به صورت متمرکز در سرویس API انجام می‌شود
5. تنظیمات پایه مثل baseURL از runtime config خوانده می‌شود

### مزایا
- جلوگیری از تکرار کد
- مدیریت متمرکز خطاها
- سهولت در نگهداری و توسعه
- یکپارچگی در مدیریت توکن و headers
- قابلیت اطمینان بیشتر در مدیریت state

### تغییرات ممنوع
❌ ایجاد composable های جداگانه برای API
❌ ارسال مستقیم درخواست fetch در کامپوننت‌ها
❌ تکرار لاجیک درخواست‌ها در store های مختلف

### تغییرات مجاز
✅ اضافه کردن متدهای جدید به گروه‌های موجود در ApiService
✅ اضافه کردن گروه‌های جدید برای قابلیت‌های جدید
✅ بهبود مدیریت خطا در سطح سرویس
✅ اضافه کردن middleware های جدید به متد request

✅ اضافه کردن سیستم دستاوردها
✅ بهبود UX/UI
✅ اضافه کردن قابلیت‌های اجتماعی
✅ بهینه‌سازی عملکرد
✅ اضافه کردن تم‌های بیشتر
✅ پشتیبانی از زبان‌های دیگر 

## مدیریت آمار و اطلاعات کاربر

### مدیریت آمار (statistics)
1. **ساختار store آمار**:
   - تمام آمار در `stores/statistics.js` مدیریت می‌شود
   - از Pinia برای مدیریت state استفاده می‌شود
   - پشتیبانی از حالت مهمان با آمار خالی
   - مدیریت خطاها به صورت فارسی

2. **انواع آمار**:
   - آمار کلی (`globalStats`)
   - آمار کاربر (`userStats`)
   - آمار پروفایل (`profileStats`)
   - آمار لیدربورد (`leaderboardStats`)
   - آمار روزانه (`dailyStats`)
   - آمار کلمات (`wordStats`)

3. **مدیریت کاربر مهمان**:
   - برای کاربر مهمان، آمار خالی نمایش داده می‌شود
   - از متد `getEmptyStats` برای ایجاد آمار خالی استفاده می‌شود
   - خطاها برای کاربر مهمان نمایش داده نمی‌شوند

4. **مدیریت خطاها**:
   - پیام‌های خطا به فارسی نمایش داده می‌شوند
   - خطاها در کنسول لاگ می‌شوند
   - خطاها در localStorage ذخیره نمی‌شوند

### مدیریت مدال مهمان
1. **نمایش مدال**:
   - مدال در `GuestModal.vue` تعریف شده است
   - نمایش مدال از طریق `auth.shouldShowGuestModal` کنترل می‌شود
   - مدال در زمان‌های زیر نمایش داده می‌شود:
     - ورود به عنوان مهمان
     - خروج از حساب کاربری
     - رفرش صفحه در حالت مهمان

2. **ترجمه‌ها**:
   - تمام متن‌های مدال در `useTranslations.js` تعریف شده‌اند
   - پشتیبانی از فارسی و انگلیسی
   - تغییر خودکار جهت (RTL/LTR) بر اساس زبان

3. **طراحی و انیمیشن‌ها**:
   - استفاده از Tailwind برای استایل‌ها
   - انیمیشن‌های ورود و خروج
   - پشتیبانی از حالت تاریک/روشن
   - طراحی واکنش‌گرا

### نکات مهم
1. هر تغییر در آمار باید از طریق `statistics.js` انجام شود
2. برای کاربر مهمان، آمار خالی نمایش داده شود
3. خطاها به صورت فارسی و کاربرپسند باشند
4. از ذخیره خطاها در localStorage خودداری شود

### مدیریت چالش روزانه
1. **ساختار چالش روزانه**:
   - کامپوننت اصلی در `pages/daily-challenge.vue`
   - استفاده از store برای مدیریت وضعیت چالش روزانه
   - ذخیره‌سازی نتایج در localStorage
   - پشتیبانی از کاربر مهمان

2. **ویژگی‌های چالش روزانه**:
   - کلمه یکسان برای همه کاربران در یک روز
   - امتیاز ویژه برای حل چالش روزانه
   - محدودیت یک بار شرکت در روز
   - نمایش زمان باقی‌مانده تا چالش بعدی

3. **مدیریت زمان**:
   - استفاده از تایمر برای نمایش زمان باقی‌مانده
   - ریست خودکار در ساعت 00:00
   - ذخیره وضعیت چالش در localStorage

4. **API های مرتبط**:
   ```javascript
   // در services/api.js
   daily = {
     getWord: () => {}, // دریافت کلمه روز
     submitResult: () => {}, // ارسال نتیجه
     getLeaderboard: () => {} // دریافت برترین‌های روز
   }
   ```

### مدیریت جدول امتیازات
1. **ساختار جدول امتیازات**:
   - کامپوننت اصلی در `pages/leaderboard.vue`
   - استفاده از store برای مدیریت داده‌ها
   - به‌روزرسانی خودکار در بازه‌های زمانی مشخص
   - پشتیبانی از فیلتر و مرتب‌سازی

2. **انواع جدول امتیازات**:
   - جدول کلی (همه زمان‌ها)
   - جدول روزانه (مخصوص چالش روز)
   - جدول هفتگی
   - جدول ماهانه

3. **ویژگی‌های جدول**:
   - نمایش رتبه کاربران
   - نمایش امتیاز و تعداد بازی‌ها
   - نمایش درصد برد
   - نمایش رکوردهای شخصی

4. **API های مرتبط**:
   ```javascript
   // در services/api.js
   leaderboard = {
     getGlobal: () => {}, // دریافت جدول کلی
     getDaily: () => {}, // دریافت جدول روزانه
     getWeekly: () => {}, // دریافت جدول هفتگی
     getMonthly: () => {} // دریافت جدول ماهانه
   }
   ```

5. **مدیریت به‌روزرسانی**:
   - به‌روزرسانی خودکار هر 5 دقیقه
   - به‌روزرسانی دستی با دکمه رفرش
   - ذخیره آخرین وضعیت در localStorage

### نکات مهم برای چالش روزانه و لیدربورد
1. استفاده از timezone سرور برای هماهنگی زمان‌ها
2. مدیریت صحیح state برای جلوگیری از تقلب
3. نمایش مناسب loading state
4. مدیریت خطاها و پیام‌های مناسب
5. پشتیبانی از حالت آفلاین

### موارد ممنوع ❌
1. دسترسی مستقیم به API بدون استفاده از store
2. ذخیره کلمه روز در کد
3. نمایش اطلاعات حساس در localStorage
4. به‌روزرسانی مکرر و غیرضروری جدول

### موارد مجاز ✅
1. اضافه کردن فیلترهای جدید به جدول
2. بهبود رابط کاربری و انیمیشن‌ها
3. اضافه کردن آمار و اطلاعات جدید
4. بهینه‌سازی عملکرد و کش‌کردن داده‌ها

## مدیریت دسترسی‌ها و کاربران

### انواع کاربران
1. **کاربران ثبت‌نام شده**:
   - دسترسی کامل به تمام قابلیت‌ها
   - امکان مشاهده لیدربورد
   - امکان مشاهده آمار
   - امکان شرکت در چالش روزانه
   - دسترسی به پروفایل شخصی
   - ذخیره امتیازات و پیشرفت

2. **کاربران مهمان**:
   - دسترسی محدود به بازی پایه
   - عدم دسترسی به لیدربورد
   - عدم دسترسی به آمار
   - عدم دسترسی به چالش روزانه
   - عدم دسترسی به پروفایل
   - عدم ذخیره امتیازات

### مدیریت وضعیت کاربر در auth store
```javascript
// stores/auth.js
export const useAuthStore = defineStore('auth', {
  state: () => ({
    isAuthenticated: false,  // وضعیت کلی احراز هویت
    isGuest: false,         // وضعیت کاربر مهمان
    token: null,            // توکن احراز هویت
    username: null          // نام کاربری
  }),

  getters: {
    // برای کاربران واقعی (نه مهمان)
    isLoggedIn: (state) => state.isAuthenticated && !state.isGuest,
    
    // برای تشخیص کاربر مهمان
    isGuestUser: (state) => state.isGuest
  }
})
```

### کنترل دسترسی در کامپوننت‌ها
1. **نمایش/مخفی کردن دکمه‌ها**:
```vue
<template v-if="authStore.isAuthenticated && !authStore.isGuest">
  <!-- دکمه‌های مخصوص کاربران ثبت‌نام شده -->
</template>
```

2. **کنترل دسترسی به مدال‌ها**:
```vue
<LeaderboardModal
  v-if="authStore.isLoggedIn"
  :is-open="isLeaderboardModalOpen"
  @close="closeModal"
/>
```

3. **بررسی دسترسی در متدها**:
```javascript
const openLeaderboardModal = () => {
  if (!authStore.isLoggedIn) {
    return
  }
  isLeaderboardModalOpen.value = true
}
```

### مدیریت خطاها
1. **پیام‌های خطا برای کاربران مهمان**:
   - استفاده از `t('pleaseLoginFirst')` برای نمایش پیام مناسب
   - ذخیره خطا در store مربوطه
   - نمایش خطا در UI با استایل مناسب

2. **بستن خودکار مدال‌ها**:
```javascript
watch(() => authStore.isAuthenticated, (isAuthenticated) => {
  if (!isAuthenticated) {
    closeAllModals()
  }
})
```

### نکات مهم
1. همیشه از `isLoggedIn` برای بررسی کاربران واقعی استفاده کنید
2. از `isAuthenticated && !isGuest` برای کنترل دسترسی در تمپلیت استفاده کنید
3. مدال‌ها را با `v-if` کنترل کنید، نه فقط با `v-show`
4. در هر درخواست API، وضعیت کاربر را بررسی کنید
5. پیام‌های خطا را به صورت واضح و به زبان کاربر نمایش دهید

### موارد ممنوع ❌
1. استفاده از `isAuthenticated` به تنهایی برای کنترل دسترسی
2. نمایش دکمه‌های غیرقابل دسترس به کاربران مهمان
3. ارسال درخواست‌های API بدون بررسی وضعیت کاربر
4. استفاده از `v-show` برای کنترل دسترسی به مدال‌ها

### موارد مجاز ✅
1. استفاده از `isLoggedIn` برای کنترل دسترسی
2. نمایش پیام‌های راهنما به کاربران مهمان
3. بررسی چندلایه دسترسی (در تمپلیت و متدها)
4. استفاده از watcher برای کنترل وضعیت مدال‌ها

## مدیریت مستندات و فازهای پروژه

### به‌روزرسانی مستندات
1. بعد از هر تغییر مهم، این راهنما باید به‌روز شود
2. تغییرات باید در بخش مربوطه ثبت شوند
3. در صورت اضافه شدن قوانین جدید، آن‌ها را به بخش مربوطه اضافه کنید
4. هر تغییر در ساختار پروژه باید در این راهنما منعکس شود

### مدیریت فازهای پروژه
1. فایل `PROJECT_PHASES.md` را برای پیگیری پیشرفت پروژه بررسی کنید
2. قبل از شروع هر تغییر، فاز مربوطه را در `PROJECT_PHASES.md` بررسی کنید
3. بعد از هر تغییر مهم، از کاربر برای به‌روزرسانی `PROJECT_PHASES.md` سؤال کنید
4. وضعیت هر فاز را در `PROJECT_PHASES.md` به‌روز نگه دارید

### چک‌لیست به‌روزرسانی مستندات
- [ ] آیا تغییرات جدید در راهنما ثبت شده‌اند؟
- [ ] آیا فازهای پروژه به‌روز شده‌اند؟
- [ ] آیا نیاز به اضافه کردن قوانین جدید وجود دارد؟
- [ ] آیا تغییرات با فاز فعلی پروژه مطابقت دارند؟

## راهنمایی‌های چالش روزانه

### ساختار کامپوننت‌ها
- استفاده از `GameBoard` موجود برای نمایش بازی
- اضافه کردن prop های جدید برای حالت چالش روزانه
- ایجاد مدال جداگانه برای نمایش آمار و رتبه‌بندی
- استفاده از سوئیچ در ناوبری برای تغییر حالت بازی

### مدیریت State
- استفاده از Pinia Store برای مدیریت state چالش روزانه
- ذخیره‌سازی پیشرفت در localStorage
- به‌روزرسانی دوره‌ای وضعیت چالش
- مدیریت خطاها و حالت‌های مختلف

### API Integration
- استفاده از متدهای موجود در `api.js`
- اضافه کردن متدهای جدید برای چالش روزانه
- مدیریت توکن و احراز هویت
- بهینه‌سازی درخواست‌ها

### UI/UX
- استفاده از رنگ‌های متناسب با تم بازی
- انیمیشن‌های روان و مناسب
- نمایش واضح وضعیت مشارکت
- سازگاری با RTL و LTR

### امنیت
- اعتبارسنجی توکن در هر درخواست
- محدودیت تعداد حدس‌ها
- جلوگیری از تقلب در زمان
- محافظت از API ها

### عملکرد
- کش کردن نتایج جدول امتیازات
- بهینه‌سازی کوئری‌های دیتابیس
- مدیریت همزمانی در ثبت حدس‌ها
- کاهش تعداد درخواست‌ها

### تست
- تست واحد برای محاسبه امتیاز
- تست یکپارچگی برای API ها
- تست عملکرد برای مدیریت همزمانی
- تست UI برای نمایش صحیح اطلاعات

### نگهداری
- پاکسازی خودکار چالش‌های قدیمی
- بهینه‌سازی دوره‌ای دیتابیس
- مانیتورینگ عملکرد
- لاگ‌گیری برای عیب‌یابی 